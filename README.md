# fastFFI: Modern and Efficient FFI for Java and C++

Basically, fastFFI has three components:

* [FFI](./ffi): DSL and API used to develop FFI applications.
* [Annotation Processor](./annotation-processor): the code generator for FFI.
* LLVM4JNI: LLVM4JNI has two submodules:
    * LLVM4JNI: a tool that translates LLVM bitcode into Java bytecode.
    * [LLVM4JNI Runtime](./llvm4jni-runtime): the runtime component used by generated bytecode.

An FFI application must include `ffi` and `llvm4jni-runtime` in its class path as runtime dependency.

## Build

1. Checkout source code 

```bash
git clone <path-to-fastffi> fastffi
```

2. Prepare building environment

```bash
export LLVM11_HOME=<path-to-llvm-11>
```

`LLVM11_HOME` should point to the home of LLVM 11. In Ubuntu, it is at `/usr/lib/llvm-11`.
Basically, the build procedure the following binary:

* `$LLVM11_HOME/bin/clang++`
* `$LLVM11_HOME/bin/ld.lld`
* `$LLVM11_HOME/lib/cmake/llvm`


3. Use fastFFI with Maven.

```xml
<dependencies>
    <!-- The FFI annotation -->
    <dependency>
        <groupId>com.alibaba.fastffi</groupId>
        <artifactId>ffi</artifactId>
        <version>0.1</version>
    </dependency>
    <!-- The FFI annotation processor for code generation -->
    <dependency>
        <groupId>com.alibaba.fastffi</groupId>
        <artifactId>annotation-processor</artifactId>
        <version>0.1</version>
    </dependency>
    <!-- The runtime component of LLVM4JNI -->
    <dependency>
        <groupId>com.alibaba.fastffi</groupId>
        <artifactId>llvm4jni-runtime</artifactId>
        <version>0.1</version>
    </dependency>
</dependencies>
```

4. Use maven to build your applications. The generated code, including Java and C++ code, is available in `<project.dir>/target/generated-source/annotations`


## FAQ

TBA
